GRP_ID=917
CC=gcc
CFLAGS=-g -Wall -z execstack -DGRP=$(GRP_ID) -DLEN1=1024 -DLEN2=128 -DLEN3=512 -DRANDOM=0

all: vuln vuln.dis driver1 driver_auth_db driver2
vuln: vuln.o
	$(CC) $(CFLAGS) -o vuln vuln.o

vuln.o: padding.h vuln.c
	$(CC) $(CFLAGS) -c vuln.c

vuln.dis: vuln
	rm -f vuln.dis
	objdump -S -M intel vuln > vuln.dis

driver1: driver_ret2helper.c
	$(CC) -O $(CFLAGS) -o driver1 driver_ret2helper.c

driver2: driver_ret2helper2.c
	$(CC) -O $(CFLAGS) -o driver2 driver_ret2helper2.c

driver_auth_db: driver_auth_db.c
	$(CC) -O $(CFLAGS) -o driver_auth_db driver_auth_db.c

padding.h:
	./mkpad $(GRP_ID)

clean:
	rm -f *.o *.dis padding.h vuln driver1
